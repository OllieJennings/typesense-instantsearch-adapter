{"version":3,"file":"Configuration.js","names":["_classCallCheck","_createClass","Configuration","_this$server$cacheSea","_options$additionalSe","_ref","_this$additionalSearc","_ref2","_this$additionalSearc2","_ref3","_this$additionalSearc3","_ref4","_this$additionalSearc4","_options$geoLocationF","_options$facetableFie","_options$collectionSp","_this","_options$flattenGroup","_options$facetByOptio","_options$filterByOpti","_options$sortByOption","_options$collectionSp2","_options$collectionSp3","_options$collectionSp4","_options$union","options","arguments","length","undefined","server","nodes","host","port","path","protocol","cacheSearchResultsForSeconds","additionalSearchParameters","query_by","queryBy","preset","sort_by","sortBy","highlight_full_fields","highlightFullFields","geoLocationField","facetableFieldsWithSpecialCharacters","collectionSpecificSearchParameters","Object","keys","forEach","collection","_params$queryBy","_params$preset","_params$sortBy","_ref5","_ref6","_params$highlightFull","params","key","renderingContent","flattenGroupedHits","facetByOptions","filterByOptions","sortByOptions","collectionSpecificFacetByOptions","collectionSpecificFilterByOptions","collectionSpecificSortByOptions","union","value","validate","values","some","c","console","warn","Error"],"sources":["../src/Configuration.js"],"sourcesContent":["\"use strict\";\n\nexport class Configuration {\n  constructor(options = {}) {\n    this.server = options.server || {\n      nodes: [\n        {\n          host: \"localhost\",\n          port: \"8108\",\n          path: \"\",\n          protocol: \"http\",\n        },\n      ],\n    };\n\n    this.server.cacheSearchResultsForSeconds = this.server.cacheSearchResultsForSeconds ?? 2 * 60;\n\n    this.additionalSearchParameters = options.additionalSearchParameters ?? {};\n\n    this.additionalSearchParameters.query_by =\n      this.additionalSearchParameters.queryBy ?? this.additionalSearchParameters.query_by ?? \"\";\n\n    this.additionalSearchParameters.preset =\n      this.additionalSearchParameters.preset ?? this.additionalSearchParameters.preset ?? \"\";\n\n    this.additionalSearchParameters.sort_by =\n      this.additionalSearchParameters.sortBy ?? this.additionalSearchParameters.sort_by ?? \"\";\n\n    this.additionalSearchParameters.highlight_full_fields =\n      this.additionalSearchParameters.highlightFullFields ??\n      this.additionalSearchParameters.highlight_full_fields ??\n      this.additionalSearchParameters.query_by;\n\n    this.geoLocationField = options.geoLocationField ?? \"_geoloc\";\n    this.facetableFieldsWithSpecialCharacters = options.facetableFieldsWithSpecialCharacters ?? [];\n\n    this.collectionSpecificSearchParameters = options.collectionSpecificSearchParameters ?? {};\n\n    Object.keys(this.collectionSpecificSearchParameters).forEach((collection) => {\n      const params = this.collectionSpecificSearchParameters[collection];\n      params.query_by = params.queryBy ?? params.query_by;\n      params.preset = params.preset ?? params.preset;\n      params.sort_by = params.sortBy ?? params.sort_by;\n      params.highlight_full_fields =\n        params.highlightFullFields ??\n        params.highlight_full_fields ??\n        this.additionalSearchParameters.highlight_full_fields ??\n        params.query_by;\n\n      // Remove undefined values\n      Object.keys(params).forEach((key) => (params[key] === undefined ? delete params[key] : {}));\n    });\n\n    this.renderingContent = options.renderingContent;\n    this.flattenGroupedHits = options.flattenGroupedHits ?? true;\n    this.facetByOptions = options.facetByOptions ?? {};\n    this.filterByOptions = options.filterByOptions ?? {};\n    this.sortByOptions = options.sortByOptions ?? {};\n    this.collectionSpecificFacetByOptions = options.collectionSpecificFacetByOptions ?? {};\n    this.collectionSpecificFilterByOptions = options.collectionSpecificFilterByOptions ?? {};\n    this.collectionSpecificSortByOptions = options.collectionSpecificSortByOptions ?? {};\n    this.union = options.union ?? false;\n  }\n\n  validate() {\n    // Warn if camelCased parameters are used, suggest using snake_cased parameters instead\n    if (\n      this.additionalSearchParameters.queryBy ||\n      Object.values(this.collectionSpecificSearchParameters).some((c) => c.queryBy)\n    ) {\n      console.warn(\n        \"[typesense-instantsearch-adapter] Please use snake_cased versions of parameters in additionalSearchParameters instead of camelCased parameters. For example: Use query_by instead of queryBy. camelCased parameters will be deprecated in a future version.\" +\n          \" We're making this change so that parameter names are identical to the ones sent to Typesense (which are all snake_cased), and to also keep the types for these parameters in sync with the types defined in typesense-js.\",\n      );\n    }\n\n    /*\n     * Either additionalSearchParameters.query_by or additionalSearchParameters.preset needs to be set, or\n     *   All collectionSpecificSearchParameters need to have query_by or preset\n     *\n     * */\n    if (\n      this.additionalSearchParameters.query_by.length === 0 &&\n      this.additionalSearchParameters.preset.length === 0 &&\n      (Object.keys(this.collectionSpecificSearchParameters).length === 0 ||\n        Object.values(this.collectionSpecificSearchParameters).some(\n          (c) => (c.query_by || \"\").length === 0 && (c.preset || \"\").length === 0,\n        ))\n    ) {\n      throw new Error(\n        \"[typesense-instantsearch-adapter] Missing parameter: One of additionalSearchParameters.query_by or additionalSearchParameters.preset needs to be set, or all collectionSpecificSearchParameters need to have either .query_by or .preset set.\",\n      );\n    }\n  }\n}\n"],"mappings":"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","ignoreList":[]}